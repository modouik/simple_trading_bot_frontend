version: '3.8'

services:
  frontend:
    container_name: frontend-tradingbot
    build:
      context: .
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_API_BASE_URL: https://admin.newwaydev.com/api
        NEXT_PUBLIC_MODE: "PRODUCTION"
        # Clé publique Turnstile (visible côté client) — à remplacer par ta vraie clé
        NEXT_PUBLIC_TURNSTILE_SITE_KEY: 0x4AAAAAACXW0IDRA8cv3Ekb
    restart: always
    ports:
      - "127.0.0.1:8081:3000"
    security_opt:
      - no-new-privileges:true
    environment:
      - NODE_ENV=production
      - COOKIE_SECURE=true
      # Lu depuis le .env (même répertoire que ce compose)
      - HMAC_SECRET=${HMAC_SECRET}
      # Clé secrète Turnstile (vérification serveur login/register)
      - TURNSTILE_SECRET_KEY=${TURNSTILE_SECRET_KEY:-}